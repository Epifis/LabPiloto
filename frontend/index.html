<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LabPilot</title>
  <meta name="google-site-verification" content="csgB9ETZ1uNsmt7WPTkVpWcwh4ZJEsF_iq0XLnAPbSk" />
  <link rel="stylesheet" href="css/styles.css" />
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log("PÃ¡gina principal cargada correctamente.");
    
    // Verificar autenticaciÃ³n en cada carga
    const token = localStorage.getItem('authToken');
    const userData = localStorage.getItem('userData');
    
    if (!token || !userData) {
        console.log('No autenticado, redirigiendo...');
        window.location.href = 'login-estudiante.html';
        return;
    }
    
    console.log('Usuario autenticado en index:', JSON.parse(userData));
    
    // Configurar cierre de sesiÃ³n
    const logoutBtn = document.getElementById("logoutBtn");
    if (logoutBtn) {
        logoutBtn.addEventListener("click", function() {
            window.authHelper.cerrarSesion();
        });
    }
});
</script>


</head>

<body>
  <header>
    <h1>LabPilot UPC</h1>
    <button class="logout-btn" id="logoutBtn">Cerrar sesiÃ³n</button>
  </header>

  <main>
    <section id="inicio">
      <h2>Haz tu reserva en la Universidad Piloto de Colombia</h2>
      <div class="botones-inicio">
        <button class="btn-inicio" id="btnLaboratorio">Reserva de Laboratorio</button>
        <button class="btn-inicio" id="btnProductos">Reserva de Productos</button>
      </div>
    </section>

    <section id="instrucciones" class="info">
      <h3>Correcto uso de LabPilot</h3>
      <p>
        Bienvenido al sistema de reservas de la Universidad Piloto de Colombia.
        Reserva laboratorios y productos de forma Ã¡gil y controlada.
      </p>
    </section>

    <!-- ================= FORMULARIO LABORATORIO ================= -->
    <section id="reservaLaboratorio" class="formulario-container" hidden>
      <h3>Reserva de Laboratorio</h3>
      
      <!-- InformaciÃ³n del usuario (solo lectura) -->
      <div class="info-usuario">
        <h4>Tu informaciÃ³n:</h4>
        <p><strong>Nombre:</strong> <span id="infoNombreLab"></span></p>
        <p><strong>Correo:</strong> <span id="infoCorreoLab"></span></p>
        <p><strong>Carrera:</strong> <span id="infoCarreraLab"></span></p>
        <p><strong>Documento:</strong> <span id="infoDocumentoLab"></span></p>
      </div>

      <form id="formLab" class="formulario">
        <label>Sala de Laboratorio:
          <select required>
            <option value="">Cargando...</option>
          </select>
        </label>

        <label>Fecha de reserva:
          <input type="date" required>
        </label>

        <label>Hora de inicio:
          <input type="time" required>
        </label>

        <label>Hora de entrega:
          <input type="time" required>
        </label>

        <!-- ðŸ”¥ NUEVO: Estudiantes adicionales -->
        <label>Â¿Participan mÃ¡s estudiantes?
          <select id="masEstudiantes">
            <option value="no">No</option>
            <option value="si">SÃ­</option>
          </select>
        </label>

        <div id="listaEstudiantes" hidden>
          <h4>Registrar estudiantes adicionales</h4>

          <div id="estudiantesContainer"></div>

          <button type="button" id="btnAgregarEstudiante" class="btn-agregar">
            + Agregar estudiante
          </button>
        </div>

        <button type="submit" class="btn-form">Enviar Reserva</button>
      </form>
    </section>

    <!-- ================= FORMULARIO PRODUCTOS ================= -->
    <section id="reservaProductos" class="formulario-container" hidden>
      <h3>Reserva de Productos</h3>
      
      <!-- InformaciÃ³n del usuario (solo lectura) -->
      <div class="info-usuario">
        <h4>Tu informaciÃ³n:</h4>
        <p><strong>Nombre:</strong> <span id="infoNombreProd"></span></p>
        <p><strong>Correo:</strong> <span id="infoCorreoProd"></span></p>
        <p><strong>Carrera:</strong> <span id="infoCarreraLab"></span></p>
        <p><strong>Documento:</strong> <span id="infoDocumentoProd"></span></p>
      </div>

      <form id="formProd" class="formulario">
        <label>Fecha de uso:
          <input type="date" required>
        </label>

        <label>Hora de inicio:
          <input type="time" required>
        </label>

        <label>Hora de entrega:
          <input type="time" required>
        </label>

        <div id="productosContainer">
          <div class="producto-item">
            <label>Producto:
              <select id="producto" required>
                <option value="">Cargando...</option>
              </select>
            </label>

            <label>Cantidad:
              <input type="number" min="1" value="1" required>
            </label>
          </div>
        </div>

        <button type="button" id="btnAgregarProducto">+ Agregar otro producto</button>

        <button type="submit" class="btn-form">Enviar Solicitud</button>
      </form>
    </section>

    <section id="contacto" class="info">
  <h3>Contacto</h3>
  <form id="formContacto">
    <label>Nombre:
      <input type="text" id="contactNombre" required>
    </label>

    <label>Correo:
      <input type="email" id="contactCorreo" required>
    </label>

    <label>Asunto:
      <input type="text" id="contactAsunto" placeholder="Soporte LabPilot">
    </label>

    <label>Mensaje:
      <textarea id="contactMensaje" required></textarea>
    </label>

    <div style="margin-top:8px;">
      <button type="submit" class="btn-form">Enviar mensaje</button>
      <!-- opcional fallback -->
    </div>

    <div id="contactStatus" style="display:none; margin-top:10px;"></div>
  </form>
</section>
  </main>

  <footer>
    <p>Â© 2025 Universidad Piloto de Colombia â€“ Sistema LabPilot</p>
  </footer>

  <script src="js/config.js"></script>
  <script src="js/events.js"></script>
  <script src="js/estudiantes.js"></script>
</body>

</html>
